#!/usr/bin/env bash

# This code is not run via github, but for local builds only
# Will check platform; win, mac, linux
# Match platform and write to Makefile setting BUILD and VERSION
# Mac and linux build-dis need the VERSION Comment out
# Windows is same but build-window script needed comment out
# variables to export
PLATFORM="$(uname -s)"
EXPORT_BUILD="linux"
EXPORT_VERSION="local-build"
echo "Running Check"
# checks windows using the MinGW
if [[  "${PLATFORM%W*}" == "MING" ]]; then
    EXPORT_BUILD="windows"
    #sed code to block VERSION
    sed -i'' -e  '1 s/./#&/' bin/build-distribution-archives
    sed -i'' -e  '2 s/./#&/' bin/build-windows-installer
else 
    if [[ $PLATFORM == "Darwin" ]]; then
        EXPORT_BUILD="osx"
    fi
    #sed code to block VERSION
    sed -i'' -e  '1 s/./#&/' bin/build-distribution-archives
    # sed code to add exports
    
fi
sed -i'' -e '$a\
export BUILD='"${EXPORT_BUILD}"'\
export VERSION='"${EXPORT_VERSION}"'\
        ' Makefile
echo "found ${EXPORT_BUILD}"

echo "Building Ink/Stich for local"
